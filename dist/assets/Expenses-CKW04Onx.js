import{j as e,A as M,m as j}from"./ui-CeF3mqTb.js";import{r}from"./router-x15TIwzH.js";import{C as h}from"./Card-BuWKqhYc.js";import{g as _,b as ee,B as c,d as se}from"./index-DCndX48W.js";import"./Input-3yWY-vqC.js";import{S as b,M as te}from"./Select-BXt2o8ak.js";import{E as ae}from"./ExpenseModal-DN2pMN-T.js";import{k as re,f as le,d as ne,j as k,l as f}from"./dateHelpers-JLmekWSI.js";import{y as ie,C as oe,z as ce,D as de,x as A}from"./icons-Dv2osvF6.js";import"./vendor-Csw2ODfV.js";import"./utils-D8kRLn_f.js";const be=()=>{const[d,T]=r.useState([]),[w,O]=r.useState([]),[L,C]=r.useState(!0),[x,$]=r.useState(""),[g,P]=r.useState(""),[p,z]=r.useState(""),[B,y]=r.useState(!1),[R,E]=r.useState(null),[U,u]=r.useState(!1),[i,S]=r.useState(null),[N,F]=r.useState("date"),[m,H]=r.useState("desc"),[I,Y]=r.useState(new Set);r.useEffect(()=>{v()},[]);const v=async()=>{C(!0);try{await new Promise(a=>setTimeout(a,500));const s=await _(),t=ee();console.log("Loaded expenses:",s),console.log("Loaded categories:",t),T(s),O(t)}catch(s){console.error("Error loading data:",s)}finally{C(!1)}},q=r.useMemo(()=>re(d),[d]),o=r.useMemo(()=>{let s=[...d];if(x&&(s=s.filter(t=>t.description.toLowerCase().includes(x.toLowerCase())||t.notes?.toLowerCase().includes(x.toLowerCase()))),g&&(s=s.filter(t=>t.categoryId===g)),p){const[t,a]=p.split("-"),l=new Date(t,a-1,1),n=new Date(t,a,0);s=le(s,l,n)}return s.sort((t,a)=>{let l=0;switch(N){case"date":l=new Date(t.date)-new Date(a.date);break;case"amount":l=t.amount-a.amount;break;case"description":l=t.description.localeCompare(a.description);break;default:l=0}return m==="asc"?l:-l}),s},[d,x,g,p,N,m]),D=ne(o),G=[{value:"",label:"All Categories"},...w.map(s=>({value:s.id,label:`${s.icon} ${s.name}`}))],J=[{value:"",label:"All Months"},...q.map(s=>({value:s,label:k(`${s}-01`,"MMMM yyyy")}))],K=[{value:"date",label:"Date"},{value:"amount",label:"Amount"},{value:"description",label:"Description"}],Q=s=>{E(s),y(!0)},V=s=>{S(s),u(!0)},W=async()=>{i&&(await se(i.id),v(),u(!1),S(null))},X=()=>{y(!1),E(null)},Z=s=>{Y(t=>{const a=new Set(t);return a.has(s)?a.delete(s):a.add(s),a})};return L?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Expenses"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage and track your expenses"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ie,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search expenses...",value:x,onChange:s=>$(s.target.value),className:"input-field pl-10 w-48"})]})]}),e.jsx(h,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(b,{options:G,value:g,onChange:s=>P(s.target.value),placeholder:"All Categories",className:"flex-1"}),e.jsx(b,{options:J,value:p,onChange:s=>z(s.target.value),placeholder:"All Months",className:"flex-1 ml-4"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(b,{options:K,value:N,onChange:s=>F(s.target.value),placeholder:"Sort by",className:"flex-1"}),e.jsxs(c,{variant:"secondary",onClick:()=>H(m==="asc"?"desc":"asc"),className:"ml-4",children:[m==="asc"?"↑":"↓"," ",m.toUpperCase()]})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(h,{padding:"small",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Expenses"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 break-all",children:["$",f(D)]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(h,{padding:"small",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Average"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 break-all",children:["$",o.length>0?f(D/o.length):"0.00"]})]})}),e.jsx(h,{padding:"small",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Transactions"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:o.length})]})})]})]}),e.jsx(h,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:o.map((s,t)=>{const a=w.find(n=>n.id===s.categoryId),l=I.has(s.id);return e.jsxs(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{delay:t*.05},className:"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/50 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors cursor-pointer",onClick:()=>Z(s.id),children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white text-lg",style:{backgroundColor:a?.color||"#6b7280"},children:a?.icon||"📝"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:s.description}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[k(s.date)," •"," ",a?.name||"Unknown"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("span",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 break-all",children:["$",f(s.amount)]}),e.jsx(j.div,{animate:{rotate:l?180:0},transition:{duration:.2},className:"text-gray-500",children:e.jsx(oe,{className:"h-4 w-4"})})]})]}),e.jsx(M,{children:l&&e.jsx(j.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"p-4 space-y-3",children:[s.notes&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Notes:"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.notes})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsxs(c,{variant:"ghost",size:"small",onClick:n=>{n.stopPropagation(),Q(s)},children:[e.jsx(ce,{className:"h-4 w-4 mr-1"}),"Edit"]}),e.jsxs(c,{variant:"ghost",size:"small",onClick:n=>{n.stopPropagation(),V(s)},children:[e.jsx(de,{className:"h-4 w-4 mr-1 text-red-500"}),"Delete"]})]})]})})})]},s.id)})}),o.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:"💸"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"No expenses found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:d.length===0?"Start tracking your expenses by adding your first expense.":"Try adjusting your filters to see more expenses."}),e.jsxs(c,{onClick:()=>y(!0),children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"Add Your First Expense"]})]})]})}),e.jsx(ae,{isOpen:B,onClose:X,expense:R,onSuccess:v}),e.jsx(j.button,{onClick:()=>y(!0),className:"fixed bottom-6 right-6 w-14 h-14 bg-gradient-to-r from-orange-500 to-red-500 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 z-50 flex items-center justify-center",whileHover:{scale:1.1},whileTap:{scale:.9},children:e.jsx(A,{className:"h-6 w-6 text-white"})}),e.jsx(te,{isOpen:U,onClose:()=>u(!1),title:"Delete Expense",size:"small",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Are you sure you want to delete this expense? This action cannot be undone."}),i&&e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:i.description}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 break-all",children:["$",f(i.amount)," •"," ",k(i.date)]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(c,{variant:"secondary",onClick:()=>u(!1),children:"Cancel"}),e.jsx(c,{variant:"danger",onClick:W,children:"Delete"})]})]})})]})};export{be as default};
