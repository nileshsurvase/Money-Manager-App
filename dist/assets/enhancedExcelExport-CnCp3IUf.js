const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/exceljs.min-BG1mft68.js","assets/vendor-Csw2ODfV.js"])))=>i.map(i=>d[i]);
import{a0 as p,i as w,h as f,b as D,a1 as F,a2 as b,D as m,a3 as A}from"./index-DbxcNNxi.js";class k{constructor(){this.ExcelJS=null,this.workbook=null}async initialize(){if(!this.ExcelJS){const i=await p(()=>import("./exceljs.min-BG1mft68.js").then(l=>l.e),__vite__mapDeps([0,1]));this.ExcelJS=i.default||i}this.workbook=new this.ExcelJS.Workbook,this.workbook.creator="ClarityOS",this.workbook.lastModifiedBy="ClarityOS",this.workbook.created=new Date,this.workbook.modified=new Date,this.workbook.lastPrinted=new Date}get styles(){return{title:{font:{name:"Segoe UI",size:20,bold:!0,color:{argb:"FF1F2937"}},alignment:{horizontal:"center",vertical:"middle"},fill:{type:"pattern",pattern:"solid",fgColor:{argb:"FFF97316"}}},header:{font:{name:"Segoe UI",size:12,bold:!0,color:{argb:"FFFFFFFF"}},alignment:{horizontal:"center",vertical:"middle"},fill:{type:"pattern",pattern:"solid",fgColor:{argb:"FF374151"}},border:{top:{style:"thin",color:{argb:"FF6B7280"}},left:{style:"thin",color:{argb:"FF6B7280"}},bottom:{style:"thin",color:{argb:"FF6B7280"}},right:{style:"thin",color:{argb:"FF6B7280"}}}},subHeader:{font:{name:"Segoe UI",size:14,bold:!0,color:{argb:"FF374151"}},alignment:{horizontal:"left",vertical:"middle"},fill:{type:"pattern",pattern:"solid",fgColor:{argb:"FFFBBF24"}}},data:{font:{name:"Segoe UI",size:10,color:{argb:"FF1F2937"}},alignment:{horizontal:"left",vertical:"middle"},border:{top:{style:"thin",color:{argb:"FFE5E7EB"}},left:{style:"thin",color:{argb:"FFE5E7EB"}},bottom:{style:"thin",color:{argb:"FFE5E7EB"}},right:{style:"thin",color:{argb:"FFE5E7EB"}}}},currency:{font:{name:"Segoe UI",size:10,color:{argb:"FF059669"},bold:!0},alignment:{horizontal:"right",vertical:"middle"},numFmt:"â‚¹#,##0.00",border:{top:{style:"thin",color:{argb:"FFE5E7EB"}},left:{style:"thin",color:{argb:"FFE5E7EB"}},bottom:{style:"thin",color:{argb:"FFE5E7EB"}},right:{style:"thin",color:{argb:"FFE5E7EB"}}}},percentage:{font:{name:"Segoe UI",size:10,color:{argb:"FF7C3AED"},bold:!0},alignment:{horizontal:"center",vertical:"middle"},numFmt:"0.00%",border:{top:{style:"thin",color:{argb:"FFE5E7EB"}},left:{style:"thin",color:{argb:"FFE5E7EB"}},bottom:{style:"thin",color:{argb:"FFE5E7EB"}},right:{style:"thin",color:{argb:"FFE5E7EB"}}}},highlight:{font:{name:"Segoe UI",size:11,bold:!0,color:{argb:"FFFFFFFF"}},alignment:{horizontal:"center",vertical:"middle"},fill:{type:"pattern",pattern:"solid",fgColor:{argb:"FFEF4444"}}}}}async createMoneyManagerReport(){await this.initialize();const i=w(),l=f(),a=D();await this.createExecutiveDashboard(i,l,a),await this.createDetailedExpensesSheet(i,a),await this.createBudgetAnalysisSheet(i,l,a),await this.createCategoryTrendsSheet(i,a),await this.createMonthlyInsightsSheet(i),await this.createFinancialHealthSheet(i,l),await this.createPredictiveAnalyticsSheet(i,l);const e=F("ClarityOS-MoneyManager","Complete-Analytics-Report");return b(this.workbook,e)}async createExecutiveDashboard(i,l,a){const e=this.workbook.addWorksheet("ðŸ“Š Executive Dashboard",{pageSetup:{paperSize:9,orientation:"landscape"}});e.mergeCells("A1:H3");const g=e.getCell("A1");g.value="ðŸŒŸ ClarityOS Money Manager - Executive Dashboard",g.style=this.styles.title,e.getCell("A5").value="ðŸ’° Key Financial Metrics",e.getCell("A5").style=this.styles.subHeader;const r=i.reduce((n,c)=>n+(c.amount||0),0),t=l.reduce((n,c)=>n+(c.amount||0),0),u=i.length>0?r/i.length:0,o=t>0?r/t:0,y=[["Total Expenses",r,"â‚¹"],["Total Budget",t,"â‚¹"],["Budget Utilization",o,"%"],["Avg Daily Expense",u,"â‚¹"],["Total Categories",a.length,"#"],["Total Transactions",i.length,"#"]];let s=7;y.forEach(([n,c,C])=>{e.getCell(`A${s}`).value=n,e.getCell(`A${s}`).style=this.styles.header,C==="â‚¹"?(e.getCell(`B${s}`).value=c,e.getCell(`B${s}`).style=this.styles.currency):C==="%"?(e.getCell(`B${s}`).value=c,e.getCell(`B${s}`).style=this.styles.percentage):(e.getCell(`B${s}`).value=c,e.getCell(`B${s}`).style=this.styles.data),s++}),e.getCell("D5").value="ðŸ“ˆ Category Breakdown",e.getCell("D5").style=this.styles.subHeader;const h={};a.forEach(n=>{h[n.id]=n.name});const d={};i.forEach(n=>{const c=h[n.categoryId]||"Unknown";d[c]=(d[c]||0)+(n.amount||0)}),s=7,Object.entries(d).sort(([,n],[,c])=>c-n).slice(0,10).forEach(([n,c])=>{e.getCell(`D${s}`).value=n,e.getCell(`D${s}`).style=this.styles.data,e.getCell(`E${s}`).value=c,e.getCell(`E${s}`).style=this.styles.currency,s++}),e.columns.forEach(n=>{n.width=20});try{const n=Object.entries(d).sort(([,C],[,E])=>E-C).slice(0,8);let c=20;e.getCell(`A${c}`).value="Chart Data - Categories",e.getCell(`A${c}`).style=this.styles.subHeader,c++,n.forEach(([C,E])=>{e.getCell(`A${c}`).value=C,e.getCell(`B${c}`).value=E,c++})}catch{console.warn("Chart creation not supported in this environment")}}async createDetailedExpensesSheet(i,l){const a=this.workbook.addWorksheet("ðŸ’³ Detailed Expenses");a.mergeCells("A1:G2");const e=a.getCell("A1");e.value="ðŸ’³ Detailed Expense Transactions",e.style=this.styles.title,["Date","Description","Category","Amount (â‚¹)","Payment Method","Notes","Created At"].forEach((t,u)=>{const o=a.getCell(4,u+1);o.value=t,o.style=this.styles.header});const r={};l.forEach(t=>{r[t.id]=t.name}),i.forEach((t,u)=>{const o=u+5;a.getCell(o,1).value=new Date(t.date),a.getCell(o,1).style={...this.styles.data,numFmt:"dd/mm/yyyy"},a.getCell(o,2).value=t.description||"",a.getCell(o,2).style=this.styles.data,a.getCell(o,3).value=r[t.categoryId]||"Unknown",a.getCell(o,3).style=this.styles.data,a.getCell(o,4).value=t.amount||0,a.getCell(o,4).style=this.styles.currency,a.getCell(o,5).value=t.paymentMethod||"Cash",a.getCell(o,5).style=this.styles.data,a.getCell(o,6).value=t.notes||"",a.getCell(o,6).style=this.styles.data,a.getCell(o,7).value=new Date(t.createdAt),a.getCell(o,7).style={...this.styles.data,numFmt:"dd/mm/yyyy hh:mm"}}),a.columns.forEach(t=>{t.width=15}),a.getColumn(2).width=25,a.getColumn(6).width=30}async createBudgetAnalysisSheet(i,l,a){const e=this.workbook.addWorksheet("ðŸŽ¯ Budget Analysis");e.mergeCells("A1:F2");const g=e.getCell("A1");g.value="ðŸŽ¯ Budget vs Actual Analysis",g.style=this.styles.title;const r={};a.forEach(y=>{r[y.id]=y.name});const t={};i.forEach(y=>{const s=y.categoryId;t[s]=(t[s]||0)+(y.amount||0)}),["Category","Budget (â‚¹)","Actual (â‚¹)","Variance (â‚¹)","Utilization %","Status"].forEach((y,s)=>{const h=e.getCell(4,s+1);h.value=y,h.style=this.styles.header});let o=5;l.forEach(y=>{const s=r[y.categoryId]||"Unknown",h=t[y.categoryId]||0,d=h-y.amount,n=y.amount>0?h/y.amount:0,c=d>0?"âš ï¸ Over Budget":n>.8?"ðŸŸ¡ Near Limit":"âœ… On Track";e.getCell(o,1).value=s,e.getCell(o,1).style=this.styles.data,e.getCell(o,2).value=y.amount,e.getCell(o,2).style=this.styles.currency,e.getCell(o,3).value=h,e.getCell(o,3).style=this.styles.currency,e.getCell(o,4).value=d,e.getCell(o,4).style=d>0?this.styles.highlight:this.styles.currency,e.getCell(o,5).value=n,e.getCell(o,5).style=this.styles.percentage,e.getCell(o,6).value=c,e.getCell(o,6).style=this.styles.data,o++}),e.columns.forEach(y=>{y.width=18})}async createMyDiaryReport(){await this.initialize();const i=m("daily"),l=m("weekly"),a=m("monthly"),e=JSON.parse(localStorage.getItem(A.WELLNESS_DATA)||"[]"),g=JSON.parse(localStorage.getItem("diary_habits")||"[]"),r=JSON.parse(localStorage.getItem("diary_habit_completions")||"{}");await this.createDiaryDashboard(i,l,a,e,g),await this.createWellnessAnalytics(e),await this.createHabitTracking(g,r),await this.createJournalInsights(i,l,a),await this.createMoodPatterns(e),await this.createPersonalGrowthReport(i,l,a);const t=F("ClarityOS-MyDiary","Complete-Wellbeing-Report");return b(this.workbook,t)}async createDiaryDashboard(i,l,a,e,g){const r=this.workbook.addWorksheet("ðŸ“– Diary Dashboard");r.mergeCells("A1:H3");const t=r.getCell("A1");t.value="ðŸ“– ClarityOS My Diary - Wellbeing Dashboard",t.style=this.styles.title,r.getCell("A5").value="ðŸ“Š Journaling Statistics",r.getCell("A5").style=this.styles.subHeader;const u=e.length>0?e.reduce((h,d)=>h+(d.mood||0),0)/e.length:0,o=e.length>0?e.reduce((h,d)=>h+(d.energy||0),0)/e.length:0,y=[["Daily Entries",i.length,"#"],["Weekly Reflections",l.length,"#"],["Monthly Reviews",a.length,"#"],["Wellness Records",e.length,"#"],["Average Mood",u.toFixed(1),"/10"],["Average Energy",o.toFixed(1),"/10"]];let s=7;y.forEach(([h,d,n])=>{r.getCell(`A${s}`).value=h,r.getCell(`A${s}`).style=this.styles.header,r.getCell(`B${s}`).value=d,r.getCell(`B${s}`).style=this.styles.data,s++}),r.getCell("D5").value="ðŸ“ Recent Daily Entries",r.getCell("D5").style=this.styles.subHeader,s=7,i.slice(-10).forEach(h=>{r.getCell(`D${s}`).value=new Date(h.date).toLocaleDateString(),r.getCell(`D${s}`).style=this.styles.data,r.getCell(`E${s}`).value=h.emotion||"",r.getCell(`E${s}`).style=this.styles.data,r.getCell(`F${s}`).value=(h.grateful||"").substring(0,50)+"...",r.getCell(`F${s}`).style=this.styles.data,s++}),r.columns.forEach(h=>{h.width=20})}async createWellnessAnalytics(i){const l=this.workbook.addWorksheet("ðŸ§˜ Wellness Analytics");l.mergeCells("A1:G2");const a=l.getCell("A1");a.value="ðŸ§˜ Wellness & Mood Analytics",a.style=this.styles.title,["Date","Mood (1-10)","Stress (1-10)","Energy (1-10)","Wellness Score","Emotions","Notes"].forEach((g,r)=>{const t=l.getCell(4,r+1);t.value=g,t.style=this.styles.header}),i.forEach((g,r)=>{const t=r+5;l.getCell(t,1).value=new Date(g.date),l.getCell(t,1).style={...this.styles.data,numFmt:"dd/mm/yyyy"},l.getCell(t,2).value=g.mood||0,l.getCell(t,2).style=this.styles.data,l.getCell(t,3).value=g.stress||0,l.getCell(t,3).style=this.styles.data,l.getCell(t,4).value=g.energy||0,l.getCell(t,4).style=this.styles.data,l.getCell(t,5).value=g.wellnessScore||0,l.getCell(t,5).style=this.styles.percentage,l.getCell(t,6).value=(g.emotions||[]).join(", "),l.getCell(t,6).style=this.styles.data,l.getCell(t,7).value=g.notes||"",l.getCell(t,7).style=this.styles.data}),l.columns.forEach(g=>{g.width=15}),l.getColumn(6).width=25,l.getColumn(7).width=30}}const v=new k,M=()=>v.createMoneyManagerReport(),$=()=>v.createMyDiaryReport();export{$ as a,M as c};
