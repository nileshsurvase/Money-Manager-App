import{j as e,m as I}from"./ui-CeF3mqTb.js";import{r as o}from"./router-x15TIwzH.js";import{C as m}from"./Card-BuWKqhYc.js";import{i as L,h as O,b as U}from"./index-DbxcNNxi.js";import{h as X,e as T,d as y,c as D,b as z,f as K,l as x}from"./dateHelpers-75khiGh5.js";import{D as W,h as q,v as H,i as J,T as Q}from"./icons-BP9Be9z0.js";import{R as A,T as S,C as V}from"./generateCategoricalChart-DLticPBC.js";import{A as Z,a as _}from"./AreaChart-DmOiwmBl.js";import{C as ee,X as se,Y as te}from"./YAxis-DqBHu9IX.js";import{P as ae,a as re}from"./PieChart-TBdxlQXX.js";import"./vendor-Csw2ODfV.js";import"./utils-BLxLozLB.js";const je=()=>{const[h,E]=o.useState([]),[C,F]=o.useState([]),[p,R]=o.useState([]),[P,M]=o.useState(!0),[N,B]=o.useState("6months");o.useEffect(()=>{Y()},[]);const Y=()=>{M(!0);try{const s=L(),a=O(),n=U();E(s),F(a),R(n)}catch(s){console.error("Error loading data:",s)}finally{M(!1)}},w=o.useMemo(()=>{const s=X(h),a=Object.keys(s).sort(),d={"3months":3,"6months":6,"1year":12}[N];return a.slice(-d).map(l=>{const c=s[l],j=T(c),g={month:new Date(l+"-01").toLocaleDateString("en-US",{month:"short",year:"2-digit"}),total:y(c),fullMonth:new Date(l+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"})};return p.forEach(f=>{g[f.name]=y(j[f.id]||[])}),g})},[h,p,N]),u=o.useMemo(()=>{const s=D(h),a=T(s);return p.map(n=>{const d=a[n.id]||[],i=y(d),l=C.find(g=>g.categoryId===n.id),c=d.length,j=c>0?i/c:0;return{...n,spent:i,budget:l?.amount||0,transactionCount:c,avgTransaction:j,percentage:l?.amount?i/l.amount*100:0}}).filter(n=>n.spent>0).sort((n,d)=>d.spent-n.spent)},[h,p,C]),t=o.useMemo(()=>{const s=D(h),{start:a,end:n}=z(),d=K(h,a,n),i=y(s),l=y(d),c=l>0?(i-l)/l*100:0,j=new Date().getDate(),g=i/j,f=u[0],b=s.map(r=>r.amount),k={"0-25":b.filter(r=>r>=0&&r<=25).length,"25-50":b.filter(r=>r>25&&r<=50).length,"50-100":b.filter(r=>r>50&&r<=100).length,"100+":b.filter(r=>r>100).length},G=Object.entries(k).reduce((r,$)=>k[r[0]]>k[$[0]]?r:$)[0];return{currentTotal:i,previousTotal:l,change:c,dailyAverage:g,topCategory:f,mostCommonRange:G,transactionCount:s.length}},[h,u]);p.reduce((s,a,n)=>(s[a.name]=a.color,s),{});const v=u.map(s=>({name:s.name,value:s.spent,color:s.color}));return P?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"spinner"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Analytics"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Insights and trends from your spending data"})]}),e.jsx("div",{className:"mt-4 sm:mt-0 flex rounded-lg border border-gray-200 dark:border-gray-700",children:[{key:"3months",label:"3M"},{key:"6months",label:"6M"},{key:"1year",label:"1Y"}].map(s=>e.jsx("button",{onClick:()=>B(s.key),className:`px-3 py-2 text-sm font-medium transition-colors ${N===s.key?"bg-primary-500 text-white":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"} ${s.key==="3months"?"rounded-l-lg":s.key==="1year"?"rounded-r-lg":""}`,children:s.label},s.key))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(W,{className:"h-8 w-8 text-primary-500"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"This Month"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:["$",x(t.currentTotal)]})]})]})}),e.jsx(m,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:t.change>=0?e.jsx(q,{className:"h-8 w-8 text-red-500"}):e.jsx(H,{className:"h-8 w-8 text-green-500"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"vs Last Month"}),e.jsxs("p",{className:`text-2xl font-bold ${t.change>=0?"text-red-500":"text-green-500"}`,children:[t.change>=0?"+":"",t.change.toFixed(1),"%"]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(J,{className:"h-8 w-8 text-accent-500"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Daily Average"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:["$",x(t.dailyAverage)]})]})]})}),e.jsx(m,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Q,{className:"h-8 w-8 text-green-500"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Transactions"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:t.transactionCount})]})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(m,{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Monthly Spending Trends"}),w.length>0?e.jsx("div",{className:"h-80",children:e.jsx(A,{width:"100%",height:"100%",children:e.jsxs(Z,{data:w,children:[e.jsx(ee,{strokeDasharray:"3 3"}),e.jsx(se,{dataKey:"month"}),e.jsx(te,{}),e.jsx(S,{formatter:s=>[`$${x(s)}`,"Amount"],labelFormatter:s=>`Month: ${s}`}),e.jsx(_,{type:"monotone",dataKey:"total",stroke:"#8b5cf6",fill:"url(#colorGradient)",strokeWidth:3}),e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#8b5cf6",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#8b5cf6",stopOpacity:0})]})})]})})}):e.jsx("div",{className:"h-80 flex items-center justify-center text-gray-500 dark:text-gray-400",children:"No data available"})]}),e.jsxs(m,{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Category Distribution (This Month)"}),v.length>0?e.jsx("div",{className:"h-80",children:e.jsx(A,{width:"100%",height:"100%",children:e.jsxs(ae,{children:[e.jsx(re,{data:v,cx:"50%",cy:"50%",outerRadius:100,fill:"#8884d8",dataKey:"value",label:({name:s,percent:a})=>`${s} ${(a*100).toFixed(0)}%`,children:v.map((s,a)=>e.jsx(V,{fill:s.color},`cell-${a}`))}),e.jsx(S,{formatter:s=>[`$${x(s)}`,"Amount"]})]})})}):e.jsx("div",{className:"h-80 flex items-center justify-center text-gray-500 dark:text-gray-400",children:"No expenses this month"})]})]}),e.jsxs(m,{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-6",children:"Category Breakdown (This Month)"}),e.jsxs("div",{className:"space-y-6",children:[u.map((s,a)=>e.jsxs(I.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:a*.1},className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white",style:{backgroundColor:s.color},children:s.icon}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[s.transactionCount," transactions â€¢ Avg: $",x(s.avgTransaction)]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:["$",x(s.spent)]}),s.budget>0&&e.jsxs("p",{className:`text-sm ${s.percentage>100?"text-red-500":s.percentage>80?"text-yellow-500":"text-green-500"}`,children:[s.percentage.toFixed(1),"% of budget"]})]})]}),s.budget>0&&e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${s.percentage>100?"bg-red-500":s.percentage>80?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(s.percentage,100)}%`}})})]},s.id)),u.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No expenses this month to analyze"})})]})]}),e.jsxs(m,{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Spending Insights"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[e.jsx("h4",{className:"font-medium text-blue-900 dark:text-blue-100 mb-2",children:"Top Spending Category"}),e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:t.topCategory?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"font-medium",children:t.topCategory.name})," accounts for"," ",e.jsxs("span",{className:"font-bold break-all",children:["$",x(t.topCategory.spent)]})," of your spending this month."]}):"No spending data available for this month."})]}),e.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800",children:[e.jsx("h4",{className:"font-medium text-green-900 dark:text-green-100 mb-2",children:"Transaction Patterns"}),e.jsxs("p",{className:"text-sm text-green-700 dark:text-green-300",children:["Most of your transactions (",t.mostCommonRange,") fall in the $",t.mostCommonRange.replace("-"," - $")," range."]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-200 dark:border-purple-800",children:[e.jsx("h4",{className:"font-medium text-purple-900 dark:text-purple-100 mb-2",children:"Monthly Comparison"}),e.jsx("p",{className:"text-sm text-purple-700 dark:text-purple-300",children:t.change>=0?e.jsxs(e.Fragment,{children:["You've spent ",e.jsxs("span",{className:"font-bold",children:[t.change.toFixed(1),"% more"]})," this month compared to last month."]}):e.jsxs(e.Fragment,{children:["You've spent ",e.jsxs("span",{className:"font-bold",children:[Math.abs(t.change).toFixed(1),"% less"]})," this month compared to last month."]})})]}),e.jsxs("div",{className:"p-4 bg-orange-50 dark:bg-orange-900/20 rounded-lg border border-orange-200 dark:border-orange-800",children:[e.jsx("h4",{className:"font-medium text-orange-900 dark:text-orange-100 mb-2",children:"Daily Spending"}),e.jsxs("p",{className:"text-sm text-orange-700 dark:text-orange-300",children:["Your daily average spending is ",e.jsxs("span",{className:"font-bold break-all",children:["$",x(t.dailyAverage)]})," this month."]})]})]})]})]})]})};export{je as default};
