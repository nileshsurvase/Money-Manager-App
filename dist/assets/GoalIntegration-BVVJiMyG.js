import{j as e,m as l,A as B}from"./ui-CeF3mqTb.js";import{r as a}from"./router-x15TIwzH.js";import{C as k}from"./Card-BuWKqhYc.js";import{D as U,B as d}from"./index-DCndX48W.js";import"./Input-3yWY-vqC.js";import{M as q,S as O}from"./Select-BXt2o8ak.js";import{g as R,a as Y,p as Z,q as J}from"./coreosStorage-BMmsarWl.js";import{g as K}from"./goalsStorage-CZXvmP6e.js";import{T as D,ac as u,Z as x,an as f}from"./icons-Dv2osvF6.js";import"./vendor-Csw2ODfV.js";import"./utils-D8kRLn_f.js";const re=()=>{const[M,N]=a.useState(!0),[m,F]=a.useState([]),[h,P]=a.useState([]),[g,E]=a.useState([]),[b,o]=a.useState(!1),[r,v]=a.useState(null),[n,w]=a.useState(""),[y,I]=a.useState("task");a.useEffect(()=>{G()},[]);const G=async()=>{N(!0);try{const[s,t,c]=await Promise.all([K(),R(),Y()]);F(s||[]),P(t||[]),E(c||[])}catch(s){console.error("Error loading goal integration data:",s)}finally{N(!1)}},T=(s,t)=>{v(s),I(t),o(!0)},$=()=>{!r||!n||(y==="task"?Z(r.id,n):J(r.id,n),o(!1),v(null),w(""),G())},C=a.useMemo(()=>m.map(s=>{const t=h.filter(i=>i.linkedGoal===s.id),c=g.filter(i=>i.linkedGoal===s.id),S=t.filter(i=>i.completed).length,L=c.filter(i=>i.completed).length,H=t.length+c.length,A=S+L,z=H>0?A/H*100:0;return{...s,linkedTasks:t.length,linkedHabits:c.length,completedTasks:S,completedHabits:L,progressFromActivities:Math.round(z),totalContributions:A}}),[m,h,g]),p=h.filter(s=>!s.linkedGoal),j=g.filter(s=>!s.linkedGoal);return M?e.jsx(U,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Goal Integration Hub"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Connect your daily activities to your long-term goals"})]}),e.jsx(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs(k,{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"Goal Progress from Daily Activities"}),e.jsxs("div",{className:"space-y-4",children:[C.map((s,t)=>e.jsxs(l.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1+t*.05},className:"p-4 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(D,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-gray-100",children:s.title}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[s.linkedTasks," tasks â€¢ ",s.linkedHabits," habits linked"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:[s.progress,"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Goal Progress"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4 mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(u,{className:"h-4 w-4 text-green-500"}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[s.completedTasks," tasks done today"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(x,{className:"h-4 w-4 text-orange-500"}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[s.completedHabits," habits completed"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex-1 mr-4",children:e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 h-2 rounded-full transition-all duration-300",style:{width:`${s.progress}%`}})})}),e.jsxs("div",{className:"text-sm font-medium text-blue-600 dark:text-blue-400",children:["+",s.progressFromActivities,"% from activities"]})]})]},s.id)),C.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(D,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"No goals yet"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Create some goals to see how your daily activities contribute to them."}),e.jsx(d,{variant:"primary",children:"Create Your First Goal"})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:e.jsxs(k,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Unlinked Tasks"}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx(f,{className:"h-4 w-4"}),e.jsxs("span",{children:[p.length," to link"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[p.map((s,t)=>e.jsxs(l.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1+t*.05},className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(u,{className:`h-5 w-5 ${s.completed?"text-green-500":"text-gray-400"}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-gray-100",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.category})]})]}),e.jsxs(d,{size:"sm",variant:"secondary",onClick:()=>T(s,"task"),className:"flex items-center space-x-1",children:[e.jsx(f,{className:"h-4 w-4"}),e.jsx("span",{children:"Link"})]})]},s.id)),p.length===0&&e.jsxs("div",{className:"text-center py-6",children:[e.jsx(u,{className:"h-12 w-12 text-green-500 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"All tasks are linked to goals!"})]})]})]})}),e.jsx(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsxs(k,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Unlinked Habits"}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx(x,{className:"h-4 w-4"}),e.jsxs("span",{children:[j.length," to link"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[j.map((s,t)=>e.jsxs(l.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1+t*.05},className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(x,{className:`h-5 w-5 ${s.completed?"text-orange-500":"text-gray-400"}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-gray-100",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[s.streak," day streak"]})]})]}),e.jsxs(d,{size:"sm",variant:"secondary",onClick:()=>T(s,"habit"),className:"flex items-center space-x-1",children:[e.jsx(f,{className:"h-4 w-4"}),e.jsx("span",{children:"Link"})]})]},s.id)),j.length===0&&e.jsxs("div",{className:"text-center py-6",children:[e.jsx(x,{className:"h-12 w-12 text-orange-500 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"All habits are linked to goals!"})]})]})]})})]}),e.jsx(B,{children:b&&e.jsx(q,{isOpen:b,onClose:()=>o(!1),title:`Link ${y} to Goal`,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Selected ",y,":"]}),e.jsx("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:r?.title||r?.name})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Choose Goal:"}),e.jsxs(O,{value:n,onChange:s=>w(s.target.value),className:"w-full",children:[e.jsx("option",{value:"",children:"Select a goal..."}),m.map(s=>e.jsxs("option",{value:s.id,children:[s.title," (",s.progress,"% complete)"]},s.id))]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-4",children:[e.jsx(d,{variant:"secondary",onClick:()=>o(!1),children:"Cancel"}),e.jsx(d,{variant:"primary",onClick:$,disabled:!n,children:"Link to Goal"})]})]})})})]})};export{re as default};
