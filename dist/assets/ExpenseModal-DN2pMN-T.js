import{j as e,m as k}from"./ui-CeF3mqTb.js";import{r as d}from"./router-x15TIwzH.js";import{M as q,S as F}from"./Select-BXt2o8ak.js";import{I as f}from"./Input-3yWY-vqC.js";import{B as S,c as O,b as D,e as P,f as M}from"./index-DCndX48W.js";const T=({isOpen:y,onClose:p,onSuccess:o})=>{const[s,r]=d.useState({name:"",icon:"📝",color:"#64748b"}),[c,n]=d.useState({}),[m,b]=d.useState(!1),x=["🍕","🛍️","🎬","💊","⚡","✈️","🛒","📈","🎁","🏡","🧹","🏦","🚗","🎮","📚","⚽","🎵","💻","🏥","🔧","🎨","📱","☕","🌮","💄","👕","🏠","🌱","🎪","🏃","📖","💳"],w=["#f97316","#3b82f6","#8b5cf6","#f59e0b","#22c55e","#6b7280","#d946ef","#06b6d4","#16a34a","#dc2626","#7c3aed","#059669","#ec4899","#84cc16","#6366f1","#ef4444","#f97316","#14b8a6"],h=a=>{const{name:l,value:g}=a.target;r(t=>({...t,[l]:g})),c[l]&&n(t=>({...t,[l]:""}))},I=a=>{r(l=>({...l,icon:a}))},C=a=>{r(l=>({...l,color:a}))},j=()=>{const a={};return s.name.trim()||(a.name="Category name is required"),s.name.trim().length<2&&(a.name="Category name must be at least 2 characters"),n(a),Object.keys(a).length===0},u=async a=>{if(a.preventDefault(),!!j()){b(!0);try{const l={name:s.name.trim(),icon:s.icon,color:s.color},g=O(l);g?(o?.(g),p(),r({name:"",icon:"📝",color:"#64748b"}),n({})):n({submit:"Failed to create category. Please try again."})}catch(l){console.error("Error creating category:",l),n({submit:"Failed to create category. Please try again."})}finally{b(!1)}}},v=()=>{p(),n({}),r({name:"",icon:"📝",color:"#64748b"})};return e.jsx(q,{isOpen:y,onClose:v,title:"Create New Category",size:"medium",children:e.jsxs("form",{onSubmit:u,className:"space-y-6",children:[e.jsx(f,{label:"Category Name",name:"name",value:s.name,onChange:h,error:c.name,placeholder:"Enter category name",required:!0}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Select Icon"}),e.jsx("div",{className:"grid grid-cols-8 gap-2",children:x.map(a=>e.jsx(k.button,{type:"button",onClick:()=>I(a),whileHover:{scale:1.1},whileTap:{scale:.9},className:`p-2 rounded-lg border-2 transition-all duration-200 ${s.icon===a?"border-orange-500 bg-orange-50 dark:bg-orange-900/30":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:e.jsx("span",{className:"text-lg",children:a})},a))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Select Color"}),e.jsx("div",{className:"grid grid-cols-6 gap-2",children:w.map(a=>e.jsx(k.button,{type:"button",onClick:()=>C(a),whileHover:{scale:1.1},whileTap:{scale:.9},className:`w-10 h-10 rounded-lg border-2 transition-all duration-200 ${s.color===a?"border-gray-400 scale-110":"border-gray-200 dark:border-gray-700"}`,style:{backgroundColor:a}},a))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Preview"}),e.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white",style:{backgroundColor:s.color},children:s.icon}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:s.name||"Category Name"})]})]}),c.submit&&e.jsx("div",{className:"text-red-600 text-sm",children:c.submit}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(S,{variant:"secondary",onClick:v,type:"button",children:"Cancel"}),e.jsx(S,{variant:"primary",type:"submit",disabled:m||!s.name.trim(),children:m?"Creating...":"Create Category"})]})]})})},H=({isOpen:y,onClose:p,expense:o=null,onSuccess:s})=>{const[r,c]=d.useState({description:o?.description||"",amount:o?.amount||"",categoryId:o?.categoryId||"",date:o?.date||new Date().toISOString().split("T")[0],notes:o?.notes||""}),[n,m]=d.useState({}),[b,x]=d.useState(!1),[w,h]=d.useState(!1),[I,C]=d.useState([]);d.useEffect(()=>{y&&C(D())},[y]),d.useEffect(()=>{c(o?{description:o.description||"",amount:o.amount||"",categoryId:o.categoryId||"",date:o.date||new Date().toISOString().split("T")[0],notes:o.notes||""}:{description:"",amount:"",categoryId:"",date:new Date().toISOString().split("T")[0],notes:""})},[o]);const j=I.filter(t=>t.id!=="add_new").map(t=>({value:t.id,label:`${t.icon} ${t.name}`}));j.push({value:"add_new",label:"➕ Add New Category"});const u=t=>{const{name:i,value:N}=t.target;if(i==="categoryId"&&N==="add_new"){h(!0);return}c(E=>({...E,[i]:N})),n[i]&&m(E=>({...E,[i]:""}))},v=t=>{C(D()),c(i=>({...i,categoryId:t.id})),h(!1)},a=()=>{const t={};return r.description.trim()||(t.description="Description is required"),(!r.amount||isNaN(r.amount)||Number(r.amount)<=0)&&(t.amount="Please enter a valid amount"),(!r.categoryId||r.categoryId==="add_new")&&(t.categoryId="Please select a category"),r.date||(t.date="Date is required"),m(t),Object.keys(t).length===0},l=async t=>{if(t.preventDefault(),!!a()){x(!0);try{const i={...r,amount:Number(r.amount)};if(o)await P(o.id,i);else{const N=await M(i);console.log("New expense added:",N)}console.log("Calling onSuccess callback"),s?.(),p(),c({description:"",amount:"",categoryId:"",date:new Date().toISOString().split("T")[0],notes:""}),m({})}catch(i){console.error("Error saving expense:",i),m({submit:"Failed to save expense. Please try again."})}finally{x(!1)}}},g=()=>{p(),m({})};return e.jsxs(e.Fragment,{children:[e.jsx(q,{isOpen:y,onClose:g,title:o?"Edit Expense":"Add New Expense",size:"medium",children:e.jsxs("form",{onSubmit:l,className:"space-y-4",children:[e.jsx(f,{label:"Product Name / Description",name:"description",value:r.description,onChange:u,error:n.description,placeholder:"Enter product name or description",required:!0}),e.jsx(f,{label:"Amount",name:"amount",type:"number",step:"0.01",min:"0",value:r.amount,onChange:u,error:n.amount,placeholder:"0.00",required:!0}),e.jsx(F,{label:"Category",name:"categoryId",value:r.categoryId,onChange:u,error:n.categoryId,options:j,placeholder:"Select a category",required:!0}),e.jsx(f,{label:"Date",name:"date",type:"date",value:r.date,onChange:u,error:n.date,required:!0}),e.jsx(f,{label:"Notes (optional)",name:"notes",value:r.notes,onChange:u,placeholder:"Add any additional notes...",multiline:!0,rows:3}),n.submit&&e.jsx("div",{className:"text-red-600 text-sm",children:n.submit}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(S,{variant:"secondary",onClick:g,type:"button",children:"Cancel"}),e.jsx(S,{variant:"primary",type:"submit",disabled:b,children:b?"Saving...":o?"Update Expense":"Add Expense"})]})]})}),e.jsx(T,{isOpen:w,onClose:()=>h(!1),onSuccess:v})]})};export{H as E};
