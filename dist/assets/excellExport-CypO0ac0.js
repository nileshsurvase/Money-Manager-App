const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/exceljs.min-BG1mft68.js","assets/vendor-Csw2ODfV.js"])))=>i.map(i=>d[i]);
import{_ as b}from"./index-DCndX48W.js";import{f as y}from"./utils-D8kRLn_f.js";import"./ui-CeF3mqTb.js";import"./router-x15TIwzH.js";import"./vendor-Csw2ODfV.js";import"./icons-Dv2osvF6.js";class A{constructor(){this.ExcelJS=null,this.workbook=null}async initialize(){if(!this.ExcelJS){const e=await b(()=>import("./exceljs.min-BG1mft68.js").then(r=>r.e),__vite__mapDeps([0,1]));this.ExcelJS=e.default,this.workbook=new this.ExcelJS.Workbook,this.setupWorkbookProperties()}}setupWorkbookProperties(){this.workbook.creator="Money Manager Pro",this.workbook.lastModifiedBy="Money Manager Pro Analytics Engine",this.workbook.created=new Date,this.workbook.modified=new Date,this.workbook.lastPrinted=new Date,this.workbook.calcProperties.fullCalcOnLoad=!0,this.workbook.views=[{x:0,y:0,width:2e4,height:15e3,firstSheet:0,activeTab:0,visibility:"visible"}]}get colors(){return{primary:"FF2563EB",secondary:"FF10B981",accent:"FFF59E0B",success:"FF059669",warning:"FFDC2626",info:"FF0891B2",light:"FFF3F4F6",medium:"FF9CA3AF",dark:"FF374151",white:"FFFFFFFF",black:"FF000000"}}get styles(){return{title:{font:{name:"Segoe UI",size:24,bold:!0,color:{argb:this.colors.dark}},alignment:{horizontal:"center",vertical:"middle"},fill:{type:"pattern",pattern:"solid",fgColor:{argb:this.colors.light}}},subtitle:{font:{name:"Segoe UI",size:16,bold:!0,color:{argb:this.colors.primary}},alignment:{horizontal:"center",vertical:"middle"}},header:{font:{name:"Segoe UI",size:12,bold:!0,color:{argb:this.colors.white}},alignment:{horizontal:"center",vertical:"middle"},fill:{type:"pattern",pattern:"solid",fgColor:{argb:this.colors.primary}},border:{top:{style:"medium",color:{argb:this.colors.dark}},left:{style:"medium",color:{argb:this.colors.dark}},bottom:{style:"medium",color:{argb:this.colors.dark}},right:{style:"medium",color:{argb:this.colors.dark}}}},data:{font:{name:"Segoe UI",size:11},alignment:{horizontal:"left",vertical:"middle"},border:{top:{style:"thin",color:{argb:this.colors.medium}},left:{style:"thin",color:{argb:this.colors.medium}},bottom:{style:"thin",color:{argb:this.colors.medium}},right:{style:"thin",color:{argb:this.colors.medium}}}},dataNumber:{font:{name:"Segoe UI",size:11},alignment:{horizontal:"right",vertical:"middle"},numFmt:"#,##0.00",border:{top:{style:"thin",color:{argb:this.colors.medium}},left:{style:"thin",color:{argb:this.colors.medium}},bottom:{style:"thin",color:{argb:this.colors.medium}},right:{style:"thin",color:{argb:this.colors.medium}}}},dataCurrency:{font:{name:"Segoe UI",size:11},alignment:{horizontal:"right",vertical:"middle"},numFmt:"$#,##0.00",border:{top:{style:"thin",color:{argb:this.colors.medium}},left:{style:"thin",color:{argb:this.colors.medium}},bottom:{style:"thin",color:{argb:this.colors.medium}},right:{style:"thin",color:{argb:this.colors.medium}}}},dataDate:{font:{name:"Segoe UI",size:11},alignment:{horizontal:"center",vertical:"middle"},numFmt:"dd/mm/yyyy",border:{top:{style:"thin",color:{argb:this.colors.medium}},left:{style:"thin",color:{argb:this.colors.medium}},bottom:{style:"thin",color:{argb:this.colors.medium}},right:{style:"thin",color:{argb:this.colors.medium}}}},summary:{font:{name:"Segoe UI",size:12,bold:!0,color:{argb:this.colors.dark}},alignment:{horizontal:"right",vertical:"middle"},fill:{type:"pattern",pattern:"solid",fgColor:{argb:this.colors.light}},border:{top:{style:"medium",color:{argb:this.colors.dark}},left:{style:"medium",color:{argb:this.colors.dark}},bottom:{style:"medium",color:{argb:this.colors.dark}},right:{style:"medium",color:{argb:this.colors.dark}}}},insight:{font:{name:"Segoe UI",size:11,italic:!0,color:{argb:this.colors.info}},alignment:{horizontal:"left",vertical:"middle",wrapText:!0},fill:{type:"pattern",pattern:"solid",fgColor:{argb:"FFF0F9FF"}}}}}async createMoneyManagerExport(e=[],r=[],o=[]){return await this.initialize(),await this.createDashboardSheet(e,r,o),await this.createExpenseAnalysisSheet(e,o),await this.createBudgetPerformanceSheet(e,r,o),await this.createMonthlyTrendsSheet(e),await this.createCategoryAnalysisSheet(e,o),await this.createFinancialHealthSheet(e,r),await this.createPredictiveAnalyticsSheet(e,r),await this.createRawDataSheet(e,r,o),this.workbook}async createDashboardSheet(e,r,o){const l=this.workbook.addWorksheet("ğŸ“Š Executive Dashboard",{pageSetup:{paperSize:9,orientation:"landscape",fitToPage:!0}});l.views=[{showGridLines:!1}];let a=1;l.mergeCells(`A${a}:L${a+1}`);const h=l.getCell(`A${a}`);h.value="MONEY MANAGER PRO - FINANCIAL DASHBOARD",h.style=this.styles.title,l.getRow(a).height=35,a+=3;const c=e.reduce((s,u)=>s+(u.amount||0),0),n=r.reduce((s,u)=>s+(u.amount||0),0),i=n>0?c/n*100:0,t=e.length>0?c/30:0;this.createKPICard(l,"A",a,"Total Expenses",c,"$#,##0.00",this.colors.warning),this.createKPICard(l,"D",a,"Total Budget",n,"$#,##0.00",this.colors.primary),this.createKPICard(l,"G",a,"Budget Usage",i,'0.0"%"',this.colors.accent),this.createKPICard(l,"J",a,"Daily Average",t,"$#,##0.00",this.colors.success),a+=5,a=await this.createCategoryBreakdownSection(l,e,o,a),a+=2,a=await this.createMonthlyTrendSection(l,e,a),a+=2,a=await this.createBudgetVsActualSection(l,e,r,o,a),a+=2,await this.createFinancialInsights(l,e,r,a),l.columns.forEach(s=>{s.width=Math.min(Math.max(s.width||10,12),25)})}createKPICard(e,r,o,l,a,h,c){const n=e.getCell(`${r}${o}`);n.value=l,n.style={font:{name:"Segoe UI",size:10,bold:!0,color:{argb:this.colors.dark}},alignment:{horizontal:"center",vertical:"middle"},fill:{type:"pattern",pattern:"solid",fgColor:{argb:this.colors.light}}};const i=e.getCell(`${r}${o+1}`);i.value=a,i.style={font:{name:"Segoe UI",size:16,bold:!0,color:{argb:c}},alignment:{horizontal:"center",vertical:"middle"},numFmt:h,fill:{type:"pattern",pattern:"solid",fgColor:{argb:this.colors.white}},border:{top:{style:"medium",color:{argb:c}},left:{style:"medium",color:{argb:c}},bottom:{style:"medium",color:{argb:c}},right:{style:"medium",color:{argb:c}}}},e.mergeCells(`${r}${o}:${String.fromCharCode(r.charCodeAt(0)+2)}${o}`),e.mergeCells(`${r}${o+1}:${String.fromCharCode(r.charCodeAt(0)+2)}${o+1}`),e.getRow(o).height=20,e.getRow(o+1).height=30}async createCategoryBreakdownSection(e,r,o,l){const a=this.calculateCategoryTotals(r,o);e.mergeCells(`A${l}:L${l}`);const h=e.getCell(`A${l}`);h.value="ğŸ’° EXPENSE BREAKDOWN BY CATEGORY",h.style=this.styles.subtitle,l+=2,["Category","Amount","Percentage","Avg per Transaction","Transaction Count"].forEach((i,t)=>{const s=e.getCell(l,t+1);s.value=i,s.style=this.styles.header}),l++;const n=Object.values(a).reduce((i,t)=>i+t.total,0);return Object.entries(a).forEach(([i,t])=>{const s=n>0?t.total/n*100:0,u=t.count>0?t.total/t.count:0,d=e.getRow(l);d.getCell(1).value=i,d.getCell(1).style=this.styles.data,d.getCell(2).value=t.total,d.getCell(2).style=this.styles.dataCurrency,d.getCell(3).value=s/100,d.getCell(3).style={...this.styles.dataNumber,numFmt:"0.0%"},d.getCell(4).value=u,d.getCell(4).style=this.styles.dataCurrency,d.getCell(5).value=t.count,d.getCell(5).style=this.styles.dataNumber,l++}),l}calculateCategoryTotals(e,r){const o={};return e.forEach(l=>{const a=l.category||"Uncategorized";o[a]||(o[a]={total:0,count:0}),o[a].total+=l.amount||0,o[a].count+=1}),o}async createMonthlyTrendSection(e,r,o){const l=this.calculateMonthlyTrends(r);e.mergeCells(`A${o}:L${o}`);const a=e.getCell(`A${o}`);a.value="ğŸ“ˆ MONTHLY SPENDING TRENDS & PATTERNS",a.style=this.styles.subtitle,o+=2,["Month","Total Spent","Transaction Count","Average Amount","Growth Rate"].forEach((n,i)=>{const t=e.getCell(o,i+1);t.value=n,t.style=this.styles.header}),o++;let c=0;return l.forEach((n,i)=>{const t=c>0?(n.total-c)/c*100:0,s=e.getRow(o);s.getCell(1).value=n.month,s.getCell(1).style=this.styles.data,s.getCell(2).value=n.total,s.getCell(2).style=this.styles.dataCurrency,s.getCell(3).value=n.count,s.getCell(3).style=this.styles.dataNumber,s.getCell(4).value=n.count>0?n.total/n.count:0,s.getCell(4).style=this.styles.dataCurrency,s.getCell(5).value=i>0?t/100:0,s.getCell(5).style={...this.styles.dataNumber,numFmt:"0.0%",font:{...this.styles.dataNumber.font,color:{argb:t>0?this.colors.warning:this.colors.success}}},c=n.total,o++}),o}calculateMonthlyTrends(e){const r={};return e.forEach(o=>{const l=new Date(o.date),a=y(l,"yyyy-MM"),h=y(l,"MMM yyyy");r[a]||(r[a]={month:h,total:0,count:0}),r[a].total+=o.amount||0,r[a].count+=1}),Object.values(r).sort((o,l)=>o.month.localeCompare(l.month))}async createBudgetVsActualSection(e,r,o,l,a){const h=this.calculateBudgetPerformance(r,o,l);e.mergeCells(`A${a}:L${a}`);const c=e.getCell(`A${a}`);return c.value="ğŸ¯ BUDGET PERFORMANCE ANALYSIS",c.style=this.styles.subtitle,a+=2,["Budget Category","Budgeted","Actual","Variance","Usage %","Status"].forEach((i,t)=>{const s=e.getCell(a,t+1);s.value=i,s.style=this.styles.header}),a++,h.forEach(i=>{const t=e.getRow(a);t.getCell(1).value=i.category,t.getCell(1).style=this.styles.data,t.getCell(2).value=i.budgeted,t.getCell(2).style=this.styles.dataCurrency,t.getCell(3).value=i.actual,t.getCell(3).style=this.styles.dataCurrency,t.getCell(4).value=i.variance,t.getCell(4).style={...this.styles.dataCurrency,font:{...this.styles.dataCurrency.font,color:{argb:i.variance>0?this.colors.warning:this.colors.success}}},t.getCell(5).value=i.usagePercent/100,t.getCell(5).style={...this.styles.dataNumber,numFmt:"0.0%"},t.getCell(6).value=i.status,t.getCell(6).style={...this.styles.data,font:{...this.styles.data.font,color:{argb:this.getStatusColor(i.status)}}},a++}),a}calculateBudgetPerformance(e,r,o){const l=this.calculateCategoryTotals(e,o);return r.map(a=>{const h=l[a.category]?.total||0,c=a.amount||0,n=h-c,i=c>0?h/c*100:0;let t="On Track";return i>100?t="Over Budget":i>80?t="Warning":i<50&&(t="Under Budget"),{category:a.category,budgeted:c,actual:h,variance:n,usagePercent:i,status:t}})}getStatusColor(e){switch(e){case"Over Budget":return this.colors.warning;case"Warning":return this.colors.accent;case"Under Budget":return this.colors.info;default:return this.colors.success}}async createFinancialInsights(e,r,o,l){e.mergeCells(`A${l}:L${l}`);const a=e.getCell(`A${l}`);return a.value="ğŸ§  AI-POWERED FINANCIAL INSIGHTS",a.style=this.styles.subtitle,l+=2,this.generateFinancialInsights(r,o).forEach(c=>{e.mergeCells(`A${l}:L${l}`);const n=e.getCell(`A${l}`);n.value=c,n.style=this.styles.insight,e.getRow(l).height=25,l++}),l}generateFinancialInsights(e,r){const o=[],l=e.reduce((t,s)=>t+(s.amount||0),0),a=e.length>0?l/e.length:0,h=this.calculateCategoryTotals(e,[]),c=Object.entries(h).sort((t,s)=>s[1].total-t[1].total)[0];if(a>100&&o.push("ğŸ’¡ Your average transaction is $"+a.toFixed(2)+". Consider reviewing larger purchases for optimization opportunities."),c){const t=(c[1].total/l*100).toFixed(1);o.push(`ğŸ“Š ${c[0]} accounts for ${t}% of your spending. This is your primary expense category.`)}const n=r.reduce((t,s)=>t+(s.amount||0),0);if(n>0){const t=(l/n*100).toFixed(1);t>90?o.push("âš ï¸ You are using "+t+"% of your budget. Consider adjusting spending or increasing budget allocations."):t<70&&o.push("âœ… Great job! You are only using "+t+"% of your budget, leaving room for savings or investments.")}const i=this.calculateMonthlyTrends(e);if(i.length>1){const t=i[i.length-1],s=i[i.length-2],u=((t.total-s.total)/s.total*100).toFixed(1);u>10?o.push(`ğŸ“ˆ Your spending increased by ${u}% this month. Review recent purchases to identify any unusual expenses.`):u<-10&&o.push(`ğŸ“‰ Excellent! Your spending decreased by ${Math.abs(u)}% this month. Keep up the good financial discipline.`)}return o.length>0?o:["ğŸ“Š Keep tracking your expenses to unlock personalized insights and recommendations."]}async createExpenseAnalysisSheet(e,r){const o=this.workbook.addWorksheet("ğŸ’³ Detailed Analysis",{pageSetup:{paperSize:9,orientation:"landscape"}});let l=1;o.mergeCells(`A${l}:J${l}`);const a=o.getCell(`A${l}`);a.value="DETAILED EXPENSE ANALYSIS",a.style=this.styles.title,l+=2,["Date","Description","Category","Amount","Day of Week","Week #","Month","Quarter","Running Total"].forEach((t,s)=>{const u=o.getCell(l,s+1);u.value=t,u.style=this.styles.header}),l++;const c=[...e].sort((t,s)=>new Date(t.date)-new Date(s.date));let n=0;c.forEach(t=>{const s=new Date(t.date),u=y(s,"EEEE"),d=Math.ceil(s.getDate()/7),m=y(s,"MMMM yyyy"),C=`Q${Math.ceil((s.getMonth()+1)/3)} ${s.getFullYear()}`;n+=t.amount||0;const g=o.getRow(l);g.getCell(1).value=s,g.getCell(1).style=this.styles.dataDate,g.getCell(2).value=t.description||"No description",g.getCell(2).style=this.styles.data,g.getCell(3).value=t.category||"Uncategorized",g.getCell(3).style=this.styles.data,g.getCell(4).value=t.amount||0,g.getCell(4).style=this.styles.dataCurrency,g.getCell(5).value=u,g.getCell(5).style=this.styles.data,g.getCell(6).value=d,g.getCell(6).style=this.styles.dataNumber,g.getCell(7).value=m,g.getCell(7).style=this.styles.data,g.getCell(8).value=C,g.getCell(8).style=this.styles.data,g.getCell(9).value=n,g.getCell(9).style=this.styles.dataCurrency,l++});const i=o.getRow(l+1);i.getCell(3).value="TOTAL:",i.getCell(3).style=this.styles.summary,i.getCell(4).value=n,i.getCell(4).style={...this.styles.summary,numFmt:"$#,##0.00"},o.columns.forEach(t=>{t.width=Math.max(t.width||10,15)})}async createBudgetPerformanceSheet(e,r,o){this.workbook.addWorksheet("ğŸ¯ Budget Performance")}async createMonthlyTrendsSheet(e){this.workbook.addWorksheet("ğŸ“ˆ Trends & Forecasts")}async createCategoryAnalysisSheet(e,r){this.workbook.addWorksheet("ğŸ·ï¸ Category Deep Dive")}async createFinancialHealthSheet(e,r){this.workbook.addWorksheet("ğŸ’š Financial Health")}async createPredictiveAnalyticsSheet(e,r){this.workbook.addWorksheet("ğŸ”® Predictions")}async createRawDataSheet(e,r,o){const l=this.workbook.addWorksheet("ğŸ“‹ Raw Data");if(e.length>0){const a=Object.keys(e[0]);a.forEach((h,c)=>{const n=l.getCell(1,c+1);n.value=h.toUpperCase(),n.style=this.styles.header}),e.forEach((h,c)=>{a.forEach((n,i)=>{const t=l.getCell(c+2,i+1);t.value=h[n],n.includes("amount")||n.includes("cost")?t.style=this.styles.dataCurrency:n.includes("date")?t.style=this.styles.dataDate:t.style=this.styles.data})})}}async getBuffer(){return await this.workbook.xlsx.writeBuffer()}async saveToFile(e){await this.workbook.xlsx.writeFile(e)}}export{A as default};
